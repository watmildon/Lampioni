<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lampioni - Italian Street Lights Map</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="stylesheet" href="https://unpkg.com/maplibre-gl@5.0.0/dist/maplibre-gl.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <canvas id="starfield"></canvas>
    <div id="map"></div>

    <!-- Header -->
    <div id="header">
        <div id="header-brand">
            <svg id="logo" viewBox="0 0 24 24" width="28" height="28" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 2C8.13 2 5 5.13 5 9c0 2.38 1.19 4.47 3 5.74V17c0 .55.45 1 1 1h6c.55 0 1-.45 1-1v-2.26c1.81-1.27 3-3.36 3-5.74 0-3.87-3.13-7-7-7z" fill="#ffd700"/>
                <path d="M9 21c0 .55.45 1 1 1h4c.55 0 1-.45 1-1v-1H9v1z" fill="#ffd700"/>
                <rect x="9" y="18" width="6" height="2" rx="0.5" fill="#ffd700" opacity="0.7"/>
                <circle cx="12" cy="9" r="2" fill="#fff" opacity="0.6"/>
            </svg>
            <h1 id="title">Lampioni</h1>
        </div>
        <div id="header-links">
            <button id="lang-toggle" title="Switch language">IT</button>
            <a href="https://community.openstreetmap.org/t/progetto-del-mese-febbraio-2026-lampioni/141180"
               target="_blank" title="OSM Italy Project">OSM Italy</a>
            <a href="https://github.com/your-repo/lampioni" target="_blank" title="GitHub">GitHub</a>
        </div>
    </div>

    <!-- Layer Controls -->
    <div id="layer-panel" class="panel">
        <h3 data-i18n="layers">Layers</h3>
        <label>
            <input type="checkbox" id="layer-baseline" checked>
            <span class="color-dot baseline"></span>
            <span data-i18n="baseline">Baseline (Feb 1)</span>
        </label>
        <label>
            <input type="checkbox" id="layer-new" checked>
            <span class="color-dot new"></span>
            <span data-i18n="newLamps">New lamps</span>
        </label>
        <label>
            <input type="checkbox" id="layer-heatmap">
            <span class="color-dot heatmap"></span>
            <span data-i18n="heatmap">Heatmap</span>
        </label>
    </div>

    <!-- Time Slider -->
    <div id="time-panel" class="panel">
        <h3 data-i18n="timeSlider">Time Travel</h3>
        <div id="time-slider-container">
            <input type="range" id="time-slider" min="0" max="100" value="100">
            <div id="time-labels">
                <span id="time-min">Feb 1</span>
                <span id="time-max">Today</span>
            </div>
        </div>
        <div id="time-display">
            <span id="time-current-date">-</span>
            <span id="time-lamp-count">-</span>
        </div>
        <div id="time-controls">
            <button id="time-play" title="Play animation">
                <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor">
                    <path d="M8 5v14l11-7z"/>
                </svg>
            </button>
            <button id="time-reset" title="Reset to today" data-i18n-title="resetToToday">
                <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor">
                    <path d="M6 18l8.5-6L6 6v12zm2-8.14L11.03 12 8 14.14V9.86zM16 6h2v12h-2z"/>
                </svg>
            </button>
        </div>
    </div>

    <!-- Stats Panel -->
    <div id="stats-panel" class="panel">
        <h3 data-i18n="statistics">Statistics</h3>
        <div class="stat-row">
            <span data-i18n="total">Total</span>
            <span id="stat-total">-</span>
        </div>
        <div class="stat-row">
            <span data-i18n="baseline">Baseline</span>
            <span id="stat-baseline">-</span>
        </div>
        <div class="stat-row">
            <span data-i18n="newSinceFeb1">New since Feb 1</span>
            <span id="stat-new">-</span>
        </div>
        <div class="stat-row updated">
            <span data-i18n="lastUpdated">Last updated</span>
            <span id="stat-updated">-</span>
        </div>

        <h4 data-i18n="topContributors">Top Contributors</h4>
        <ol id="leaderboard"></ol>
    </div>

    <!-- Loading Indicator -->
    <div id="loading">
        <div class="spinner"></div>
        <span data-i18n="loading">Loading data...</span>
    </div>

    <script src="https://unpkg.com/maplibre-gl@5.0.0/dist/maplibre-gl.js"></script>
    <script src="i18n.js"></script>
    <script src="lampioni.js"></script>
</body>
</html>
